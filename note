    @staticmethod
    def create_data_for_model():
        all_predict_assessment, label_data = DataUtil.__pre_process_train_label_data()
        all_train_assessment = label_data['game_session'].unique()
        train_data = []
        test_data = []
        for file_path in [DataUtil.session_train_data, DataUtil.session_test_data]:
            all_path = os.path.join(DataUtil.create_path, file_path)
            if os.path.exists(all_path):
                df = DataUtil.get_data_from_file(all_path)
            else:
                df = DataUtil.create_session_features(all_path)
            groups = df.groupby(['installation_id'])
            for installation_id, data in groups:
                accumulate_dic = {}
                for code in DataUtil.event_code_list:
                    accumulate_dic[code] = 0
                accumulate_start_line = 0
                last_assessment_session = None
                for i, row in data.iterrows():
                    if row['type'] == 'Assessment':
                        if row['game_session'] in all_train_assessment or row['game_session'] in all_predict_assessment:
                            accumulate_data = data[accumulate_start_line: i + 1]
                            if last_assessment_session is None:
                                label = label_data.keys()
                            else:
                                label = label_data[label_data['game_session'] == last_assessment_session]
                            if row['game_session'] in all_train_assessment:
                                DataUtil.__create_assessment_data(accumulate_data, label, last_assessment_session,
                                                                  train_data)
                            else:
                                DataUtil.__create_assessment_data(accumulate_data, label, last_assessment_session,
                                                                  test_data)
                            accumulate_start_line = i
                            last_assessment_session = row['game_session']
        return pd.DataFrame(train_data), pd.DataFrame(test_data)
        
            @staticmethod
    def __create_assessment_data(accumulate_data, label, last_assessment_session, data):
        new_data = accumulate_data.iloc[[-1]][DataUtil.columns_list]
        accumulate_data.drop(columns=DataUtil.columns_list)
        accumulate = accumulate_data[:-1][DataUtil.event_code_list].sum()
        accumulate.append(label.drop('game_session'))
        if last_assessment_session is not None:
            for name in accumulate.index:
                accumulate[name] += data[-1][name]
        new_data.append(accumulate)
        data.append(new_data)
        
        
        
            @staticmethod
    def create_session_features(data_file):
        if 'train' in data_file:
            data = DataUtil.get_data_from_raw_file(DataUtil.train_data)
        else:
            data = DataUtil.get_data_from_raw_file(DataUtil.test_data)
        length = len(data['game_session'].unique())
        print(length)
        all_a = 0
        last_id = None
        last_session = None
        for i, row in data.iterrows():
            if row['installation_id'] != last_id or row['game_session'] != last_session:
                all_a += 1
            if all_a % 1000 == 0:
                print(all_a)
        print(all)
        session_features_dic = {}
        for column in DataUtil.columns_list:
            session_features_dic[column] = [0] * length
        for code in DataUtil.event_code_list:
            session_features_dic[code] = [0] * length
        for title in DataUtil.session_title_list:
            session_features_dic[title] = [0] * length
        for s_type in DataUtil.session_type_list:
            session_features_dic[s_type] = [0] * length
        for world in DataUtil.session_world_list:
            session_features_dic[world] = [0] * length
        id_groups_data = data.groupby(['installation_id'], as_index=False)
        session_count = -1
        for _, id_data in id_groups_data:
            game_session = None
            start_row = -1
            id_data = id_data.reset_index(drop=True)
            for i, row in id_data.iterrows():
                if row['game_session'] != game_session:
                    if game_session is not None:
                        session_count += 1
                        DataUtil.__get_feature_one_session(id_data[start_row:i], session_features_dic, session_count)
                    game_session = row['game_session']
                    start_row = i
            session_count += 1
            DataUtil.__get_feature_one_session(id_data[start_row:], session_features_dic, session_count)
        df = pd.DataFrame(session_features_dic)
        df.to_csv(os.path.join(DataUtil.create_path, 'session_' + data_file), index=False)
        return df
