
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.decomposition import TruncatedSVD
vectorizer = TfidfVectorizer(sublinear_tf=True, max_df=0.5, stop_words='english')
train_data = vectorizer.fit_transform(train.data)
test_data = vectorizer.transform(test.data)
print(train_data.shape)
print(test_data.shape)


from sklearn.naive_bayes import MultinomialNB
from sklearn.svm import LinearSVC
from sklearn.metrics import accuracy_score
from sklearn.metrics import f1_score
#clf = MultinomialNB()
clf = clf = LinearSVC()
clf.fit(train_data,train.target)
test_predict = clf.predict(test_data)
accuracy = accuracy_score(test.target, test_predict)
F1 = f1_score(test.target, test_predict, average='macro') 
F1s = f1_score(test.target, test_predict,  average=None)
print("The accuracy is " + str(round(accuracy , 2)) + " and the F1 is " + str(round(F1 , 2)))
for  i in range(0,number_of_type):
    print(categories[i] + " F1 is " + str(F1s[i]))
    
    
    sklearn文本分类记录【1】 官方文档  
    使用gensim和sklearn搭建一个文本分类器【1】
